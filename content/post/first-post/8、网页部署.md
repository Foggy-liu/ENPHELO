## 8、网页部署

### Github

#### Github仓库

打开[Github网站]( https://github.com/new ) ，在 **Repository name** 里填写你在 安装 Stack 主题 中使用的仓库名，然后点击 **Create repository** 。

![Github仓库1](img8.1.png)

![Github仓库1](img8.2.png)

#### 将文件上传到Github

因为我们上传文件只需要上传源代码，所以可以在根目录下**创建一个*.gitignore* 文件**，并在文件中添加

```
public
resources
.vscode/
.hugo_build.lock
desktop.ini
```

这样，当后续执行 `git add .` 时，Git 就会自动忽略 `public` 等文件夹，不会把它们加入版本跟踪，最终也就不会上传到 GitHub。

在根目录下打开终端，或者在终端下执行 cd D：HugoSite\根目录，然后依次执行以下命令：

```powershell
git remote add origin https://github.com/Github账号名/刚刚设置的仓库名.git   #关联远程仓库
git add .    # 添加文件
git commit -m "first commit: initial upload of 你的项目名 project"   # 提交，引号里的文字是说明，可自定义
git branch -M main   #  确保分支名
git push -u origin main  # 推送
```

执行完毕之后，如果你以后更新你的网站，那么只需要执行以下命令即可更新你的仓库：

```powershell
git add .
git commit -m "这里写上你的更新说明"
git push
```

一定要确定你输入的账号和仓库是否正确，如果出现错误可以使用以下命令来查看和修改：

```powershell
git remote -v                         # 查看当前配置
git remote remove origin              # 删除旧配置
git remote add origin https://github.com/Github账号名/刚刚设置的仓库名.git  # 添加新配置
git remote -v                         # 确认配置已更新
git push -u origin main               # 推送到正确的仓库
```

最后，别忘记写一个简单的README.md介绍文件。执行代码跟上面的更新仓库代码一样，也可以单独上传这个文件：

```powershell
git add README.md
git commit -m "docs: add README file"
git push
```

## 9、网站发布

### Vercel

**Vercel** 是一个**专注于前端项目的云端部署平台**。它可以让你在几分钟内将网站发布到互联网上，并提供一个免费的、高效的访问地址。

打开 [Vercel网站](https://vercel.com/)，注册或登录你的账号，与Github相关联，一开始应该就在这个界面。

![image-20250824142339462](D:\Hugosite\ENPHELO\content\post\first-post\image-20250824142339462.png)

如果不是，那么找到你的头像，在Overveiw界面，点击 Account Settings，然后如下操作就可以转入上面这个界面。

![image-20250824141944075](D:\Hugosite\ENPHELO\content\post\first-post\image-20250824141944075.png)

随后点击 install 按钮，即可查看到你的github 仓库项目。选择刚刚创建的仓库，点击 import

![image-20250824142509146](D:\Hugosite\ENPHELO\content\post\first-post\image-20250824142509146.png)

将 **Framework Preset** 设置成 **Hugo** 模式，然后点击下方的 **Build and Output Settings**，填写：

```
hugo --gc --minify
```

![image-20250824143158489](D:\Hugosite\ENPHELO\content\post\first-post\image-20250824143158489.png)

再点击 **Environment Variables** ，**Key** 中填写 `HUGO_VERSION`， **Value** 中填写 `你的hugo版本号`，如果这个版本号导致加载失败，那么可以通过查看 [Vercel 的官方文档](https://vercel.com/docs/frameworks/hugo#supported-versions) 查看他们支持的版本。或者直接尝试一些常见的稳定版本，比如：`0.132.3`（一个较新的稳定版）`0.125.7` `0.124.1` `0.123.8`（我这里尝试了 0.125.7 ）

随后将刚刚的版本号更换即可。

![image-20250824143341875](D:\Hugosite\ENPHELO\content\post\first-post\image-20250824143341875.png)

保存设置后，点击 **Deploy**，等待……当 Status 是 Ready 的时候则部署成功。

![image-20250824144959043](D:\Hugosite\ENPHELO\content\post\first-post\image-20250824144959043.png)

就可以点击上面 **Domains** 下的链接打开你的网站了。

### 自定义域名

可以看到，默认的域名是 `xxxx.vercel.app`，这个域名不仅不美观，更重要的是，他在国内基本处于无法访问的状态。所以我们接下来的步骤就是自定义域名。

点击项目上方的 **Setting** ，随后点击 **Domains**，点击右上方的 **Add Domain**，如图所示：

![image-20250824152424442](D:\Hugosite\ENPHELO\content\post\first-post\image-20250824152424442.png)

![image-20250824152552255](D:\Hugosite\ENPHELO\content\post\first-post\image-20250824152552255.png)

如果没有域名的话可以去注册一个，一般是需要付费的，我会单开一个文章另外说明。

点击 **Add Domain** 后，输入 **你的域名** 并且使 **「Connect to an environment」** 下面，确保 **「Production」** 被选中，随后点击 **Save** 。

最后别忘记将配置文件 **config.yaml** 中的访问路径 **baseurl** 更改为你的新域名，并在根目录下使用更新代码：

```powershell
# 在项目根目录下执行：
git add config.yaml
git commit -m "fix: update baseURL to production domain"
git push origin main
```

将修改后的代码**推送到 GitHub**，从而触发 Vercel 重新部署。

那么现在你访问的域名就可以更改了，你可以直接在网站上输入你的域名来访问你的博客。

### 配置文件域名更换（补充）

虽然config配置文件当中的 baseurl 并不影响你使用你的域名访问，但是为了美观还是统一更改。

```
baseurl: 你的域名
```

然后执行构建 hugo --gc --minify 命令，把这个 public 文件部署到服务器就行了。注意，不能使用 hugo server 去构建。

```sh
hugo --gc --minify
```

如果上述不成功，查看你的public里面有没有 **vercel.json** 文件，没有的话那么需要创建一个 **vercel.json** 文件（可以放置在根目录下面），并将以下代码填入其中：

```json
{
  "buildCommand": "hugo --gc --minify",
  "outputDirectory": "public",
  "cleanUrls": true,
  "routes": [
    {
      "src": "/",
      "dest": "/index.html"
    },
    {
      "src": "/(.*)",
      "dest": "/$1"
    }
  ],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "Content-Type",
          "value": "text/html; charset=utf-8"
        }
      ]
    }
  ]
}
```

随后重新部署：

```powershell
# 清除旧构建
Remove-Item -Recurse -Force public

# 重新构建（Vercel 会自动使用 vercel.json 中的配置）
hugo --gc --minify

# 提交和推送
git add .
git commit -m "fix: add vercel.json to resolve content-type issue"
git push
```

